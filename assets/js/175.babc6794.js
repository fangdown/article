(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{272:function(t,e,n){"use strict";n.r(e);var s=n(0),r=Object(s.a)({},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[t._m(0),t._m(1),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),n("p",[n("a",{attrs:{href:"https://my.oschina.net/u/3018050/blog/1936780",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),n("OutboundLink")],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"centeros部署nginx-node-pm2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#centeros部署nginx-node-pm2","aria-hidden":"true"}},[this._v("#")]),this._v(" centerOS部署nginx+node+pm2")])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("还原安装过程，总结经验，避坑")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"一、服务器环境部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、服务器环境部署","aria-hidden":"true"}},[this._v("#")]),this._v(" 一、服务器环境部署")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("安装node")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("下载最新的node进行安装")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("wget http://nodejs.org/dist/v9.9.0/node-v9.9.0-linux-x64.tar.gz #下载\ntar xvzf node-v9.9.0-linux-x64.tar.gz #解压\ncd node-v9.9.0-linux-x64 #进入解压文件目录\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("配置node、npm软连接")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("ln -s /root/node/bin/node /usr/local/bin/node  \nln -s /root/node4/bin/npm /usr/local/bin/npm\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("安装查看")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("node -v\nnpm -v\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"2"}},[e("li",[this._v("安装pm2")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("npm i pm2 -g\nln -s /root/node/bin/pm2 /usr/local/bin/pm2\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"3"}},[e("li",[this._v("安装nginx")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("yum install nginx\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"二、项目安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、项目安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 二、项目安装")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("项目拷贝")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("git clone git@xxxxxxx/xxxxx.git  #或者直接上传项目文件夹\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"2"}},[e("li",[this._v("安装依赖")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("cd xxx //项目目录\nnpm install \n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"三、启动项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、启动项目","aria-hidden":"true"}},[this._v("#")]),this._v(" 三、启动项目")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("配置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("nginx配置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("新建文件todo.conf")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("upstream todo {\n  server 127.0.0.1:8888; #这里要和启动项目的PORT端口一致\n  keepalive 64;\n}\nserver {\n  listen 80;\n  server_name www.xxxxx.com; #填写必须是已备案的域名，不然解析会出错。没有域名可填写服务器ip\n  root         /root/projects/VUE-SSR-TECH; #项目favicon.ico所在文件夹\n  location / {\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwardered-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Nginx-Proxy true;\n    proxy_set_header Connection '';\n    proxy_pass http://todo; #这里要和最上面upstream后的应用名一致,可以自定义\n  }\n}\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("json配置")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('1. 简单版：pm2 start app.js\n2. json方式\n// weather.json\n{\n  "apps": [\n    {\n      "name": "weather",\n      "cwd": "/root/github/node/koa2-mongodb",\n      "script": "/root/github/node/koa2-mongodb/app.js",\n      "log_date_format": "YYYY-MM-DD HH:mm Z",\n      "error_file": "/var/log/node-app/node-app.stderr.log",\n      "out_file": "log/node-app.stdout.log",\n      "pid_file": "pids/node-geo-api.pid",\n      "instances": 6,\n      "min_uptime": "200s",\n      "max_restarts": 10,\n      "max_memory_restart": "1M",\n      "cron_restart": "1 0 * * *",\n      "watch": false,\n      "merge_logs": true,\n      "exec_interpreter": "node",\n      "exec_mode": "fork",\n      "autorestart": false,\n      "vizion": false\n    }\n  ]\n}\n// package.json\n"scripts": {\n  "pm2": "pm2 start weather.json"\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"2"}},[e("li",[this._v("启动项目")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// 启动nginx\nsudo ln -s /root/github/node/koa2-mongodb/todo.conf /etc/nginx/conf.d/  #nginx启动文件的软链接\nservice nginx start #启动nginx服务\ncd xxx #进入项目根目录\n\n// 启动pm2\npm2 start app.js\n或\nnpm run pm2\n")])])])}],!1,null,null,null);e.default=r.exports}}]);